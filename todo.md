para fazer as stats: quando há um search, atualizar counters, quando ha uma mudança, mandar ao client.

no balanceamento de carga, em vez do for estranho, fazer um while que tenta até conseguir mandar.